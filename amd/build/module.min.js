define ("block_blc_modules/module",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.bulkUpdateInit=a.tippyInit=a.init=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var c=M.cfg.wwwroot,d="",e=function(a,b){var c=decodeURIComponent(a.split("?")[1]),d=c.split("#"),e,f;for(f=0;f<d.length;f++){e=d[f].split("=");if(e[0]===b){return e[1]===void 0?!0:e[1]}}},f=function(){var a=(0,b.default)("#apikey").val();b.default.getJSON(c+"/blocks/blc_modules/load_scormsubject.php?apikey="+encodeURIComponent(a),function(a){var c=[];if(0==a.length){(0,b.default)(".submitForm").attr("disabled","disabled");(0,b.default)(".statusMsg").html("<span style=\"color:red;\">An error has occured.</p>")}b.default.each(a,function(a,b){c.push("<option value='"+a+"'>"+b+"</option>")});c=c.sort();(0,b.default)("#scormsubject").html(c.join(""))})},g=function(a){var d=(0,b.default)("#apikey").val();b.default.getJSON(c+"/blocks/blc_modules/version_check.php?apikey="+encodeURIComponent(d)+"&id="+a,function(a){b.default.each(a,function(a,c){(0,b.default)("#module-"+a+" .mod-indent-outer .activityinstance").append("<li class=\"cmid-version\" id=\""+a+"-"+c+"\"><i id=\"updatescorm\"  style=\"cursor: pointer;\" class=\"icon fa fa-refresh fa-fw \" title=\"New version available\" aria-label=\"Update\"></i>")})})},h=function(){var a=(0,b.default)("#scormsubject option:selected").text(),d=(0,b.default)("#apikey").val();if(0!=a){b.default.getJSON(c+"/blocks/blc_modules/load_scormurls.php?apikey="+encodeURIComponent(d)+"&subject="+encodeURIComponent(a),function(a){var c=[];b.default.each(a,function(a,b){var d=b.replace(".zip",""),a=a.replace("'","\u2019");c.push("<option style='-moz-white-space: pre-wrap; -o-white-space: pre-wrap; white-space: pre-wrap;' value='"+a+"'>"+d+"</option>")});(0,b.default)("#scormurls").html(c.join(""))})}},i=function(a,d){b.default.ajax({type:"GET",url:c+"/blocks/blc_modules/update_scorm.php",data:"cmid="+a+"&version="+d,beforeSend:function beforeSend(){(0,b.default)("#module-"+a+" .mod-indent-outer .cmid-version").append("<i class=\"fa fa-spinner fa-spin\" style=\"font-size:24px\"></i>")},success:function success(){location.reload(!0)}})},j=function(){var a=(0,b.default)(location).attr("href");a=a.split("&")[0];a=a.split("#")[0];var j=e(a,"id"),k=(0,b.default)("#userediting").val();if(1==k)g(j);if((0,b.default)("#addscorm").hasClass("block_blc_modules")){var k=(0,b.default)("#userediting").val(),l=(0,b.default)("#allowstealthvalue").val(),m="";if(1==l){m="<option value=\"-1\">Make available but not shown</option>"}var n=(0,b.default)("#completionon").val(),o="";if(1==n){o="<select class=\"custom-select \" name=\"completion\" id=\"id_completion\"> <option value=\"0\">Off</option> <option value=\"1\" >Manual</option> <option value=\"2\" selected=\"\">Automatic</option> </select> <div class=\"form-control-feedback invalid-feedback\" id=\"id_error_completion\">"}else{o="<p>Activity completion is not enabled on this course.</p><div class=\"form-control-feedback invalid-feedback\" id=\"id_error_completion\">"}(0,b.default)(".course-content").append("<div style=\"display:none;\" class=\"modal fade\" id=\"bsModal3\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"mySmallModalLabel\" aria-hidden=\"true\"> <div class=\"modal-dialog modal-md\"> <div class=\"modal-content\"> <div class=\"modal-header\"> <h4 class=\"modal-title\" id=\"mySmallModalLabel\">Select BLC Modules</h4> </div> <div class=\"modal-body\"> <p class=\"statusMsg\"></p> <form role=\"form\"> <div class=\"form-group\"> <select style=\"min-width:100%;\" class=\"form-control\" id=\"scormsubject\" name=\"scormsubject\"> </select> </div> <div class=\"form-group\"> <select style=\"min-width:100%;\" class=\"form-control\" id=\"scormurls\" name=\"scormurls\" multiple > </select> </div> <div class=\"additional_settings\"> <h3>SCORM Settings</h3> <div class=\"blcrow\"> <div class=\"blcrow\"> <span style=\"float:left; margin-right:10px;\" class=\"text-nowrap\"> <a style=\"box-shadow: none; background: none; padding-bottom:3px !important; border:none;\" class=\"btn btn-link p-0 avail\" id=\"\"  role=\"button\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"right\" data-content=\"<div class=&quot;no-overflow&quot;><p>If the availability is set to 'Show on course page', the activity or resource is available to students (subject to any access restrictions which may be set).<br /><br /> If the availability is set to 'Hide from students', the activity or resource is only available to users with permission to view hidden activities (by default, users with the role of teacher or non-editing teacher).<br /><br /> If the course contains many activities or resources, the course page may be simplified by setting the availability to 'Make available but not shown on course page'. In this case, a link to the activity or resource must be provided from elsewhere, such as from a page resource. The activity would still be listed in the gradebook and other reports.</p> </div> \" data-html=\"true\" tabindex=\"0\" data-trigger=\"focus\"> <img src=\""+c+"/blocks/blc_modules/pix/question.png\" style=\"max-width: 20px;\" onclick=\"event.preventDefault();\" aria-hidden=\"true\" title=\"Help with Availability\" aria-label=\"Help with Availability\" /> </a> </span> <label style=\"line-height: 18px;\" class=\"blclabel\" for=\"id_visible\"> Availability </label> </div> <div class=\"blcrow\" data-fieldtype=\"modvisible\"> <select class=\"custom-select \" name=\"visible\" id=\"id_visible\"> <option value=\"1\" selected=\"\">Show on course page</option> <option value=\"0\">Hide from students</option>"+m+"</select> <div class=\"form-control-feedback invalid-feedback\" id=\"id_error_visible\"> </div> </div> </div> <br/> <div class=\"blcrow\" > <div class=\"blccolmd6\"> <span style=\"float:left; margin-right:10px;\" class=\"text-nowrap\"> <a style=\"box-shadow: none; background: none; padding-bottom:3px !important; border:none;\" class=\"btn btn-link p-0 prev\" role=\"button\" id=\"\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"right\" data-content=\"<div class=&quot;no-overflow&quot;><p>Preview mode allows a student to browse an activity before attempting it. If preview mode is disabled, the preview button is hidden.</p> </div> \" data-html=\"true\" tabindex=\"0\" data-trigger=\"focus\"> <img src=\"../blocks/blc_modules/pix/question.png\" style=\"max-width: 20px;\" onclick=\"event.preventDefault();\" aria-hidden=\"true\" title=\"Help with Availability\" aria-label=\"Help with Availability\" /> </a> </span> <label style=\"line-height: 18px;\" class=\"blclabel\" for=\"id_hidebrowse\"> Disable preview mode </label> </div> <div class=\"blcrow\" style=\"\" data-fieldtype=\"selectyesno\"> <select class=\"custom-select \" name=\"hidebrowse\" id=\"id_hidebrowse\"> <option value=\"0\">No</option> <option value=\"1\" selected=\"\">Yes</option> </select> <div class=\"form-control-feedback invalid-feedback\" id=\"id_error_hidebrowse\"> </div> </div> </div> <br/> <div class=\"blcrow\" > <div class=\"blccolmd6\"> <span style=\"float:left; margin-right:10px;\" class=\"text-nowrap\"> <a style=\"box-shadow: none; background: none; padding-bottom:3px !important; border:none;\" class=\"btn btn-link p-0 comp\" id=\"\" role=\"button\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"right\" data-content=\"<div class=&quot;no-overflow&quot;><p>If enabled, activity completion is tracked, either manually or automatically.<br/> If Automatic is selected, the best options for BLC modules are set, whereas if manual is selected, the studnt must manually tick a box next to the activity for it to register as complete.</p> <p>A tick next to the activity name on the course page indicates when the activity is complete.</p> </div>\" data-html=\"true\" tabindex=\"0\" data-trigger=\"focus\"> <img src=\"../blocks/blc_modules/pix/question.png\" style=\"max-width: 20px;\" onclick=\"event.preventDefault();\" aria-hidden=\"true\" title=\"Help with Availability\" aria-label=\"Help with Availability\" /> </a> </span> <label class=\"blclabel\" style=\"line-height: 18px;\" for=\"id_completion\"> Completion tracking </label> </div> <div class=\"blccolmd6\"  style=\"\" data-fieldtype=\"select\" >"+o+"</div> </div> </div> </div> </div> <div class=\"modal-footer\"> <button type=\"button\" class=\"btn btn-default closeModal\" data-dismiss=\"modal\">Close</button> <button type=\"button\" disabled=\"disabled\" class=\"btn btn-primary submitForm\" >Add Modules</button> </div> </div> </div> </div> ");var p=(0,b.default)("#section-0 .content").css("margin-right"),q=(0,b.default)("#wwwroot_hidden").html();(0,b.default)(".section.main").each(function(){if(1==k)(0,b.default)(this).append("<a style='float:right; margin-right:"+p+"; cursor: pointer; color: #a864a8;' class='add-scrom' data-toggle='modal' data-target='#bsModal3'><img style='padding-bottom:3px;' src='"+c+"/blocks/blc_modules/pix/blc.png'/>   Add BLC modules</a>");var a=(0,b.default)(".row").css("margin-left");if("-30px"==a||"-20px"==a){(0,b.default)(".form-group").css("margin-left","5px");(0,b.default)(".float-sm-right").css("float","left")}});(0,b.default)("#scormsubject").change(function(){h()});(0,b.default)(".course-content").on("click",".add-scrom",function(){f();var a=(0,b.default)(this).closest(".section").attr("id"),c=a.split("-")[1];d=c});(0,b.default)("#scormurls").click(function(){(0,b.default)(".submitForm").removeAttr("disabled")});(0,b.default)(".course-content").on("click",".submitForm",function(){var a=(0,b.default)("#apikey").val(),e=[],f=(0,b.default)("#id_visible").val(),g=(0,b.default)("#id_hidebrowse").val(),h=(0,b.default)("#id_completion").val();b.default.each((0,b.default)("#scormurls option:selected"),function(){var a=(0,b.default)(this).val();a=a.replace(",","qqq");e.push(a)});(0,b.default)(".statusMsg").html("");(0,b.default)(".submitForm").attr("disabled","disabled");(0,b.default)(".closeModal").attr("disabled","disabled");(0,b.default)(".modal-header").append("<i class=\"fa fa-spinner fa-spin\" style=\"font-size:24px\"></i>");b.default.get(c+"/blocks/blc_modules/load_scorm.php",{id:j,sectionNumber:d,scormurls:e,apikey:a,visibility:f,hidebrowse:g,completion:h},function(a){if("\"completed\""==a){location.reload(!0)}else{(0,b.default)(".statusMsg").html("<span style=\"color:red;\">"+a+"</p>");(0,b.default)(".submitForm").removeAttr("disabled");(0,b.default)(".modal-header .fa.fa-spinner").remove()}})})}(0,b.default)(".activityinstance").on("click",".fa-refresh",function(){var a=(0,b.default)(this).closest(".cmid-version").attr("id"),c=a.split("-")[0],d=a.split("-")[1];i(c,d)})};a.init=j;a.tippyInit=function tippyInit(){tippy(".avail",{content:"<div class=&quot;no-overflow&quot;><p>If the availability is set to 'Show on course page', the activity or resource is available to students (subject to any access restrictions which may be set).<br /><br /> If the availability is set to 'Hide from students', the activity or resource is only available to users with permission to view hidden activities (by default, users with the role of teacher or non-editing teacher).<br /><br /> If the course contains many activities or resources, the course page may be simplified by setting the availability to 'Make available but not shown on course page'. In this case, a link to the activity or resource must be provided from elsewhere, such as from a page resource. The activity would still be listed in the gradebook and other reports.</p> </div> ",theme:"light",arrow:!0,placement:"right"});tippy(".prev",{content:"<div class=&quot;no-overflow&quot;><p>Preview mode allows a student to browse an activity before attempting it. If preview mode is disabled, the preview button is hidden.</p> </div> ",theme:"light",arrow:!0,placement:"right"});tippy(".comp",{content:"<div class=&quot;no-overflow&quot;><p>If enabled, activity completion is tracked, either manually or automatically.<br/> If Automatic is selected, the best options for BLC modules are set, whereas if manual is selected, the studnt must manually tick a box next to the activity for it to register as complete.</p> <p>A tick next to the activity name on the course page indicates when the activity is complete.</p> </div>",theme:"light",arrow:!0,placement:"right"})};var k=function(){(0,b.default)(document).ready(function(){var a=setInterval(function(){if((0,b.default)("#modalForm").modal){(0,b.default)("#modalForm").modal("show");(0,b.default)("#bulkupdatecont").click(function(){(0,b.default)("#bulkupdatesubmit").submit()});clearInterval(a)}},500)})};a.bulkUpdateInit=k});
//# sourceMappingURL=module.min.js.map
